# UI設計進捗

## 2025年11月26日

### ✅ 実装完了した機能

#### 1. バージョン情報表示
- トップページの左下にバージョン情報（v.1.0.0）を小さく表示
- 半透明の白テキストで目立たないデザイン

#### 2. 開発用パスワード認証
- 開発環境でのみ有効なパスワード認証機能（パスワード: `dev1234`）
- `/memories/create`ページに直接アクセスした際、開発環境ではパスワード認証を表示
- 認証成功後、`sessionStorage`に`devAuth`フラグを保存
- パスワードフォームの下部に「開発用パスワード: dev1234」を表示

#### 3. タイトルサイズのデフォルト値変更
- エディットページと公開ページのタイトルサイズのデフォルト値を48pxから35pxに変更
- 設定パネルでも35pxが初期値として表示

#### 4. 新規作成制限の強化
- LP経由（`/claim`経由）でないと新規メモリページを作成できないように制限
- 直接URLからアクセスした場合、「新規作成はできません」画面を表示
- 開発環境では「開発用パスワードで認証」ボタンを表示
- `fromClaim`フラグを使用してLP経由のアクセスを厳密に判定

#### 5. 認証チェックの改善
- 認証状態を`useState`の初期値から`sessionStorage`を直接読み込むように改善
- 開発用認証状態のチェックを毎回実行
- キャッシュ問題を解決

#### 6. デプロイとGit管理
- Firebase Hostingへのデプロイ完了
- Git push完了（リポジトリ: `https://github.com/Koheui/emolink-CMS.git`）

### 🔧 技術的な改善

- 認証チェックの順序を最適化
- 開発環境判定を`window.location.hostname`も含めて改善
- `sessionStorage`を使用した認証状態管理

---

## 2025年10月26日

### トップページ（`src/app/page.tsx`）

#### ✅ 完成した機能
- 全画面写真表示
- タイトルとサブタイトルの編集可能（クリックで編集モード）
- フォントサイズ調整スライダー（タイトル：24px-120px、サブタイトル：12px-32px）
- 文字位置のドラッグ＆ドロップ
- 改行対応（Textarea使用）
- 「Go」ボタンを矢印アイコンのみに変更
- 矢印ボタンもドラッグ＆ドロップ可能
- 初期テキスト設定：
  - タイトル：「大切な想い出をいつまでも」
  - サブタイトル：「一度きりの想い出を残してください」

#### 🎨 デザイン
- 背景：全画面画像表示
- 要素：max-widthで中央配置、背景は100%幅
- テキスト：白文字にtext-shadowで視認性確保
- スライダー：カスタムスタイル（グラデーション付きサム）

---

### メインページ（`src/app/memories/create/page.tsx`）

#### ✅ 完成した機能

##### 1. ヘッダー部分
- カバー画像を削除
- 左上にプロフィール写真（円形、20x20）
- 右上にタイトル（クリックで編集可能）
- タイトルの下にbio（複数行入力可能、textarea）

##### 2. コンテンツブロック
- **通常の写真（`type: 'image'`）**
  - 1枚の写真を表示
  - タイトルと説明を入力可能
  - アイコン：📷 写真

- **アルバム（`type: 'album'`）**
  - 複数写真をまとめて管理
  - 各写真にタイトルと説明を入力可能
  - アルバムの最後に「写真を追加」ボタン
  - 後からでも写真を追加可能
  - アイコン：📚 アルバム

- **動画（`type: 'video'`）**
  - 動画を再生可能
  - タイトルと説明を入力可能
  - アイコン：🎥 動画

- **音声（`type: 'audio'`）**
  - 音声ファイル
  - タイトルと説明を入力可能
  - アイコン：🎵 音声

##### 3. アップロードメニュー
- 2×2グリッドレイアウト
- 「写真」：単独写真をアップロード
- 「アルバム」：複数写真をまとめてアップロード（紫で区別）
- 「動画」：動画をアップロード
- 「音声」：音声をアップロード

##### 4. データ構造
```typescript
interface AlbumItem {
  id: string;
  url: string;
  title?: string;
  description?: string;
}

interface MediaBlock {
  id: string;
  type: 'image' | 'video' | 'audio' | 'album';
  url?: string;  // 通常メディア用
  thumbnail?: string;
  visibility: 'public' | 'private';
  title?: string;  // ブロック全体のタイトル
  description?: string;  // ブロック全体の説明
  albumItems?: AlbumItem[];  // アルバム用
}
```

#### 🎨 デザイン
- 背景：青〜シアンのグラデーション（`bg-gradient-to-br from-blue-600 to-cyan-600`）
- 要素：最大幅2xl、中央配置
- カード：白背景、角丸、シャドウ
- アップロードメニュー：紫でアルバムを区別

---

## 2025年1月（CMS機能とデザイン構築）

### CMS管理画面

#### ✅ 完成した機能

##### 1. 共通レイアウトコンポーネント（`src/components/admin-layout.tsx`）
- **サイドバー**: 固定サイドバー（デスクトップ）、ドロワー（モバイル）
- **ナビゲーション**: ダッシュボード、想い出管理、ユーザー管理、テナント管理、注文管理
- **ユーザー情報表示**: プロフィール画像、メールアドレス、テナント情報
- **レスポンシブデザイン**: モバイル対応（ハンバーガーメニュー）
- **アクティブ状態**: 現在のページをハイライト表示

##### 2. ダッシュボード（`src/app/dashboard/page.tsx`）
- **統計カード**: 総想い出数、公開済み、下書きの統計表示
- **クイックアクション**: よく使う機能への素早いアクセス
- **Firebase接続状態**: リアルタイム接続状態の表示
- **セキュリティ情報**: テナント分離、Origin検証、アクセス制御の状況
- **想い出一覧**: 作成した想い出ページの一覧表示

##### 3. テナント管理（`src/app/admin/tenants/page.tsx`）
- **テーブル表示**: テナント情報をテーブル形式で表示
- **新規作成フォーム**: モーダル形式のテナント作成フォーム
- **編集機能**: テナント情報の編集
- **設定画面へのリンク**: 各テナントの詳細設定画面への遷移
- **ステータス管理**: active/inactive/suspendedのステータス表示

##### 4. ユーザー管理（`src/app/admin/users/page.tsx`）
- **テーブル表示**: ユーザー情報をテーブル形式で表示
- **ステータス管理**: pending → verified → processing → shippedのワークフロー
- **一括操作**: ステータス変更の一括処理
- **テナントフィルタ**: テナント別のユーザー表示

##### 5. UIコンポーネント
- **Tableコンポーネント**: 統一されたテーブルデザイン（`src/components/ui/table.tsx`）
- **Cardコンポーネント**: 既存のCardコンポーネントを活用
- **Buttonコンポーネント**: 統一されたボタンデザイン
- **Badgeコンポーネント**: ステータス表示用

#### 🎨 デザインシステム
- **カラーパレット**: 青〜シアンのグラデーションをメインカラーに
- **タイポグラフィ**: 統一されたフォントサイズとウェイト
- **スペーシング**: 一貫した余白とパディング
- **レスポンシブ**: モバイル、タブレット、デスクトップ対応
- **アニメーション**: ホバー効果、トランジション

---

### 📋 今後の予定

#### CMS機能拡張
- メモリー管理画面の改善（一覧、編集、公開機能）
- 注文管理画面の実装
- 検索・フィルタ機能の追加
- バルク操作機能の追加

#### 公開ページ
- トップページとメインページのデザインを公開ページにも反映
- アクリルスタンド（印刷）機能
- NFCタグ機能

#### 機能追加
- アルバム内の写真の削除機能
- アルバム内の写真の順序変更機能
- カバー画像の設定（最初の写真をカバーに）

---

### 🔑 技術スタック
- Next.js 14（App Router）
- TypeScript
- Tailwind CSS
- Firebase（Firestore、Storage）
- React Hooks
- Lucide React（アイコン）
